# 🎬 비디오 편집기

브라우저 기반 종합 비디오 편집 도구 - 캡처, 편집, 필터, GIF 생성, 역재생

## 🚨 중요: 로컬 서버 실행 필요

이 애플리케이션은 FFmpeg.wasm과 Web Workers를 사용하기 때문에 **반드시 로컬 HTTP 서버에서 실행**해야 합니다.
`file://` 프로토콜로 직접 열면 CORS 에러가 발생합니다.

## 🚀 빠른 시작

### ✅ 권장: Node.js 서버

**한 번만 설치:**
```bash
npm install
```

**실행:**
```bash
npm start
```

자동으로 브라우저가 열립니다! (`http://localhost:8000`)

### 대체 방법: Python 서버

```bash
python start_server.py
```

⚠️ 주의: `python -m http.server`는 FFmpeg에 필요한 보안 헤더를 제공하지 않아 역재생 기능이 작동하지 않습니다.

## ✨ 전체 기능 목록

### 📁 비디오 불러오기
- **로컬 파일 업로드**: 컴퓨터에서 직접 비디오 파일 선택
- **URL 입력**: 온라인 비디오 URL로 로드
- **폴더 선택**: 저장 폴더 지정 가능 (File System Access API)

### 🎨 필터 및 효과 (신규!)
실시간 미리보기와 모든 캡처 기능에 자동 적용

#### 수동 조절
- **밝기** (Brightness): 0~200%
- **대비** (Contrast): 0~200%
- **채도** (Saturation): 0~200%
- **색상** (Hue): 0~360도
- **블러** (Blur): 0~10px
- **흑백** (Grayscale): 0~100%

#### 프리셋 필터
- 🔄 필터 초기화
- ⚫ 흑백 (Black & White)
- 🟤 세피아 (Sepia)
- 📷 빈티지 (Vintage)
- 🌈 선명하게 (Vivid)

### 📸 프레임 캡처

#### 단일 캡처
- **PNG 캡처**: 현재 프레임을 PNG 이미지로 저장 (무손실)
- **JPG 캡처**: 현재 프레임을 JPG 이미지로 저장 (고압축)
- **텍스트/워터마크 추가**: 캡처 시 텍스트 오버레이
  - 텍스트 내용 입력
  - 폰트 크기 선택 (16px~128px)
  - 색상 선택 (흰색, 검정, 빨강, 파랑, 노랑, 녹색 등)
  - 위치 선택 (상단, 중앙, 하단)
  - 스타일 선택 (배경 있음/투명)
- **타임스탬프 자동 표시**: 현재 재생 시간 자동 추가

#### 간격 캡처 (신규!)
비디오 구간에서 일정 간격으로 자동 캡처
- **시작/종료 시간**: 캡처할 구간 지정
- **간격 설정**: 0.5초, 1초, 2초, 3초, 5초, 10초 또는 직접 입력
- **자동 시퀀싱**: `interval_capture_001.jpg`, `002.jpg` 형식
- **진행률 표시**: 실시간 캡처 진행 상황
- **필터 적용**: 설정된 필터 자동 적용

#### 썸네일 생성기 (신규!)
비디오 전체에서 대표 장면 자동 추출
- **개수 선택**: 4개(2x2), 6개(3x2), 9개(3x3), 12개(4x3), 16개(4x4)
- **크기 선택**: 160px, 240px, 320px, 480px
- **출력 형식**:
  - 단일 그리드 이미지: 모든 썸네일을 하나의 이미지로 결합
  - 개별 이미지: 각 썸네일을 별도 파일로 저장
- **포맷**: PNG/JPG 선택
- **자동 균등 분포**: 비디오 전체에서 균등한 간격으로 자동 선택
- **타임스탬프**: 각 썸네일에 시간 표시 옵션

### ✂️ 구간 잘라내기
**드래그 타임라인으로 구간 선택** (신규!)
- **타임라인 드래그**:
  - ◀ 시작 핸들과 ▶ 종료 핸들을 마우스/터치로 드래그
  - 실시간 시간 표시 및 비디오 미리보기
  - 비디오 플레이어 크기에 맞춰 자동 조정
  - 드래그 중 해당 구간으로 비디오 자동 이동
- **FPS 선택**: 24fps, 30fps, 60fps
- **품질 설정**: 3~10 Mbps
- **WebM 출력**: VP9 코덱 사용
- **필터 적용**: 설정된 필터로 처리
- **마우스/터치 지원**: 데스크톱 및 모바일 모두 완벽 지원

### 🎞️ GIF 생성
**드래그 타임라인으로 구간 선택** (신규!)
- **타임라인 드래그**:
  - ◀ 시작 핸들과 ▶ 종료 핸들을 마우스/터치로 드래그
  - 실시간 시간 표시
  - 비디오 플레이어 크기에 맞춰 자동 조정
  - 구간 잘라내기와 동일한 직관적 UI
- **프레임 레이트** 선택 (5~30 fps)
- **출력 크기** 조정 (240px~1920px)
- **필터 적용**: 설정된 필터로 GIF 생성
- **실시간 진행률** 표시
- **마우스/터치 지원**: 데스크톱 및 모바일 모두 완벽 지원

### ⏱️ 슬로우 모션 (신규!)
**드래그 타임라인으로 구간 선택**
선택한 구간만 슬로우 모션 적용, 나머지는 정상 속도 유지
- **타임라인 드래그**:
  - ◀ 시작 핸들과 ▶ 종료 핸들로 슬로우 구간 선택
  - 구간 잘라내기와 동일한 직관적 UI
  - 실시간 시간 표시
- **슬로우 속도**: 8단계 선택 가능
  - 0.1x (극도로 느림) ~ 0.8x (살짝 느림)
  - 0.1x, 0.2x, 0.25x, 0.33x, 0.5x, 0.67x, 0.75x, 0.8x
- **3구간 처리**:
  - 구간 1: 시작~슬로우구간 (정상 속도)
  - 구간 2: 슬로우 구간 (느린 속도)
  - 구간 3: 슬로우구간~끝 (정상 속도)
- **FPS 선택**: 30fps, 60fps (권장)
- **품질 선택**: 3~10 Mbps
- **WebM 출력**: VP9/VP8 코덱
- **필터 적용**: 설정된 필터로 슬로우 모션 생성
- **진행률 표시**: 실시간 처리 상황

### ⏪ 역재생 비디오
전체 비디오를 역재생으로 변환
- **FPS 선택**: 30fps, 40fps, 50fps, 60fps (기본: 60fps)
- **품질 선택**: 3~10 Mbps (기본: 8 Mbps 고품질)
- **WebM 출력**: VP9/VP8 코덱
- **필터 적용**: 설정된 필터로 역재생 생성
- **진행률 표시**: 실시간 처리 상황

### ⚙️ 재생 제어
- **재생 속도**: 0.25x ~ 2x 속도 조절
- **프레임별 이동**: 정밀한 위치 제어
- **진행률 바**: 드래그로 빠른 이동

## 💡 사용 팁

### 필터 활용
1. **실시간 미리보기**: 슬라이더 조정 시 비디오에 즉시 반영
2. **프리셋 활용**: 빠른 효과 적용 후 세부 조정
3. **모든 캡처에 적용**: 설정한 필터가 모든 캡처 기능에 자동 적용됨

### 품질 vs 속도
- **60fps + 고품질(8Mbps)**: 최고 품질, 파일 크기 큼, 처리 느림
- **30fps + 중간(5Mbps)**: 균형잡힌 선택
- **24fps + 낮음(3Mbps)**: 빠른 처리, 작은 파일 크기

### 썸네일 생성
- **그리드 모드**: 한 장의 이미지로 전체 내용 파악
- **개별 모드**: 각 장면을 별도 파일로 관리
- **크기 선택**: 용도에 따라 조정 (웹용 240px, 인쇄용 480px)

### GIF 최적화
- FPS와 크기를 낮추면 파일 크기가 작아집니다
- 지속 시간을 짧게 설정하면 처리 속도 향상
- CORS가 허용된 URL만 사용 가능

### 간격 캡처 활용
- 영상 분석: 1초 간격으로 전체 영상 프레임 추출
- 품질 검토: 0.5초 간격으로 세밀한 검토
- 대표 장면: 5~10초 간격으로 주요 장면만 추출

## 🛠️ 기술 스택

### 핵심 기술
- **Canvas API**: 고품질 프레임 캡처, 필터 적용, 이미지 처리
- **MediaRecorder API**: 실시간 비디오 녹화 및 인코딩
- **GIF.js**: Web Worker 기반 GIF 생성
- **HTML5 Video**: 비디오 재생 및 조작
- **File System Access API**: 폴더 선택 및 파일 저장

### 비디오 코덱
- **WebM/VP9**: 역재생 및 트림 출력 형식
- **고품질 인코딩**: 최대 10 Mbps 비트레이트 지원

### 이미지 형식
- **PNG**: 무손실 압축, 투명도 지원
- **JPEG**: 높은 압축률, 작은 파일 크기
- **GIF**: 애니메이션 지원

## 📂 프로젝트 구조

```
video/
├── index.html          # 메인 애플리케이션 (단일 파일)
├── gif.js             # GIF 생성 라이브러리
├── gif.worker.js      # GIF 생성 Web Worker
├── server.js          # Node.js 개발 서버
├── start_server.py    # Python 개발 서버
├── package.json       # Node.js 의존성
├── README.md          # 이 파일
└── DEVELOPMENT.md     # 개발 문서 및 이력
```

## 📝 문제 해결

### GIF 생성이 느림
→ FPS를 낮추거나 지속 시간을 짧게 설정해보세요.
→ Web Worker를 사용하므로 백그라운드에서 처리됩니다.

### 역재생/트림 비디오가 끊겨 보임
→ **60fps + 고품질(8Mbps)**로 설정하세요.
→ 30fps는 빠르지만 덜 부드럽고, 60fps는 느리지만 매우 부드럽습니다.

### 비디오 생성이 느림
→ 정상입니다. 모든 프레임을 추출하므로 시간이 걸립니다.
→ 빠른 처리를 원하면 **30fps + 낮음(3Mbps)**으로 설정하세요.

### WebM 파일이 재생되지 않음
→ **VLC Player, Chrome, Firefox** 등 WebM을 지원하는 플레이어를 사용하세요.
→ MP4로 변환하려면 **HandBrake** 또는 **FFmpeg**를 사용하세요.

### 필터가 적용되지 않음
→ 필터 슬라이더를 조정한 후 캡처/생성 버튼을 눌러주세요.
→ 비디오 플레이어에서 실시간 미리보기를 확인할 수 있습니다.

### 폴더 선택이 작동하지 않음
→ **Chrome** 또는 **Edge** 브라우저를 사용하세요.
→ File System Access API는 일부 브라우저에서만 지원됩니다.

### CORS 에러 발생
→ 로컬 서버(`npm start`)로 실행 중인지 확인하세요.
→ URL 비디오는 CORS가 허용된 서버에서만 작동합니다.

## 🔄 업데이트 내역

### v2.2 (2025-11-17) - 슬로우 모션 기능 ⏱️
- ✨ **슬로우 모션 비디오 생성**
  - 선택 구간만 슬로우 모션 적용, 나머지는 정상 속도
  - 드래그 타임라인으로 슬로우 구간 선택 (기존 UI 재사용)
  - 8단계 속도 옵션: 0.1x ~ 0.8x (극도로 느림 ~ 살짝 느림)
  - 전체 비디오를 3구간으로 나누어 처리
  - 60fps 고품질 출력 지원
  - 필터 자동 적용

### v2.1 (2025-11-17) - 드래그 타임라인 UI 🎯
- ✨ **GIF 생성 타임라인 드래그 기능**
  - 구간 잘라내기와 동일한 직관적 UI 적용
  - 마우스/터치 이벤트 완벽 지원
  - 실시간 시간 표시 및 핸들 드래그
  - Chrome Device Toolbar 모드 호환
  - Playwright 자동화 테스트 완료
- 🔧 타임라인 레이아웃 수직 배치 개선
- 🔧 인라인 이벤트 핸들러로 브라우저 호환성 향상
- 🔧 터치 이벤트 지원으로 모바일 경험 개선
- 🎨 핸들 호버 효과 및 시각 피드백 개선

### v2.0 (2025-11) - 종합 편집 도구 완성 🎉
- ✨ 텍스트/워터마크 기능 추가
- ✨ 타임스탬프 자동 표시
- ✨ 프레임 간격 캡처 기능
- ✨ 구간 잘라내기(트림) 기능
- ✨ 밝기/대비/필터 조절 (6가지 필터 + 5가지 프리셋)
- ✨ 썸네일 생성기 (그리드/개별 모드)
- 🎨 실시간 필터 미리보기
- 🔧 모든 캡처 기능에 필터 자동 적용

### v1.0 (이전 버전)
- 📸 기본 프레임 캡처 (PNG/JPG)
- 🎞️ GIF 생성
- ⏪ 역재생 비디오
- 📁 파일/URL 로드

## 📚 추가 문서

- **[DEVELOPMENT.md](DEVELOPMENT.md)**: 개발 가이드, 기술 상세, API 문서

## 📄 라이선스

내부 작업용 도구
